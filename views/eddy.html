<!-- vusers.html -->
{{$session := .Session}}
{{$appid := .AppId}}
{{$portail := .Portail}}
{{$app := .Application}}
{{$theme := .Config.Theme}}
{{$composter := .Composter}}
{{$record := .Record}}
{{$keyid := .KeyID}}
{{$methodurl := .URL}}
<!DOCTYPE html>
<html>
{{template "_crud_head.html" .}}
<body>
  <!-- NAVBAR -->
  <div class="ui container">
    <div class="ui large fixed secondary grey inverted menu navbar bee-bar-light">
      <div class="item">
        <button class="ui labeled icon {{$theme}} button crud-jquery-close">
          <i class="left arrow icon"></i>
          Fermer
        </button>
      </div>
      <h3 class="header item"><i class="file code large icon"></i> {{$record.Path}}</h3>
      <!-- RIGHT MENU -->
      <div class="right menu">
        <div class="item">
          <button class="ui icon {{$theme}} button eddy-window-open"
          data-url="{{.Config.HelpPath}}{{if eq $record.Path `portail.yaml`}}/dico-portail-help/{{else}}/dico-table-help/{{end}}"
          data-width="900" data-posy="50" target="eddy-help" title="Aide Éditeur...">
            <i class="help icon"></i>
          </button>
        </div>
        <div class="item">
          <button id="button_validate" class="ui icon red button crud-jquery-submit" disabled="disabled"
            title="Enregistrer">
            <i class="save icon"></i>
          </button>
        </div>
        <div class="ui dropdown item">
          <i class="ellipsis vertical icon"></i>
          <div class="menu">
            {{range $file := $portail.Files}}
            {{if eq $file.Ext ".yaml"}}
            <a class="ui icon {{if eq $record.Path $file.Base}}active{{end}} item eddy-window-open" data-url="/bee/eddy/document/{{$file.Base}}" 
            data-posx="right" target="{{$file.Base}}">
              <i class="file code brown icon"></i>{{$file.Base}}</a>
            {{else}}
            <a class="ui icon item eddy-window-open" data-url="/bee/eddy/document/{{$file.Base}}" 
            data-posx="right" target="{{$file.Base}}">
              <i class="project diagram orange icon"></i>{{$file.Base}}</a>
            {{end}}
            {{end}}
          </div>
        </div>
        <!-- end dropdown MENU à droite -->
      </div>
      <!-- end right menu -->
    </div>
  </div>
  <!-- MAIN -->
  <main>
    <div class="ui container">
      {{template "_crud_flash.html" .}}
      <!-- Formulaire d'Edition -->
      <form class="ui form attached segment" id="beeForm" method="POST" action="{{$methodurl}}">
        {{ .xsrfdata }}
        <input type="hidden" id="cursor_ch" name="cursor_ch" value="{{.CursorCh}}">
        <input type="hidden" id="cursor_line" name="cursor_line" value="{{.CursorLine}}">
        <div class="ui form">
          <section>
            <div class="field">
              <textarea id="codemirror-markdown" name="document" id="document">{{$record.Content}}</textarea>
            </div>
          </section>
        </div>
      </form>
    </div>
    </div> <!-- /container -->
  </main>
  <!-- Demande de confirmation de l'action' -->
  <div id="crud-modal-confirm" class="ui modal">
    <div class="header" id="crud-action">Texte à venir</div>
    <div class="content">
      <p>Veuillez le confirmer</p>
    </div>
    <div class="actions">
      <div class="ui cancel button">Annuler</div>
      <div class="ui approve button">Je confirme</div>
    </div>
  </div> <!-- end modal confirm -->

  <!-- CONTEXTE -->
  <input type="hidden" id="eddy_refresh" value="eddy-refresh">
  <input type="hidden" id="eddy_rubriques" value="{{.Rubriques}}">
  {{template "_crud_foot.html" .}}
</body>

</html>